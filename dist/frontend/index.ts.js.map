{"version":3,"file":"index.ts.js","mappings":"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","sources":["webpack://dmn-booking-plugin/./node_modules/react-dom/client.js","webpack://dmn-booking-plugin/./src/frontend/api/http.ts","webpack://dmn-booking-plugin/./src/frontend/api/public.ts","webpack://dmn-booking-plugin/./src/frontend/app/WidgetRoot.tsx","webpack://dmn-booking-plugin/./src/frontend/app/state.ts","webpack://dmn-booking-plugin/./src/frontend/index.tsx","webpack://dmn-booking-plugin/./src/frontend/styles/index.scss","webpack://dmn-booking-plugin/external window \"React\"","webpack://dmn-booking-plugin/external window \"ReactDOM\"","webpack://dmn-booking-plugin/external window \"ReactJSXRuntime\"","webpack://dmn-booking-plugin/webpack/bootstrap","webpack://dmn-booking-plugin/webpack/runtime/compat get default export","webpack://dmn-booking-plugin/webpack/runtime/define property getters","webpack://dmn-booking-plugin/webpack/runtime/hasOwnProperty shorthand","webpack://dmn-booking-plugin/webpack/runtime/make namespace object","webpack://dmn-booking-plugin/./src/frontend/index.ts"],"sourcesContent":["'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","const DEBUG = true; // flip to false to disable logging\n\nfunction getHeadersAsRecord(headers: Headers): Record<string, string> {\n  const out: Record<string, string> = {};\n  headers.forEach((value, key) => {\n    out[key] = value;\n  });\n  return out;\n}\n\nexport async function j<T>(path: string, init?: RequestInit): Promise<T> {\n  const url = window.DMN_PUBLIC_BOOT.restUrl + path;\n\n  const started = performance.now();\n  const res = await fetch(url, {\n    ...init,\n    headers: { 'Content-Type': 'application/json', ...(init?.headers || {}) },\n  });\n\n  let data: any;\n  try {\n    data = await res.clone().json();\n  } catch {\n    data = await res.text();\n  }\n\n  if (DEBUG) {\n    console.groupCollapsed(\n      `%c[DMN]%c ${init?.method || 'GET'} ${path} %c${res.status}`,\n      'color:#6DA8A6;font-weight:600',\n      'color:inherit',\n      `color:${res.ok ? '#16a34a' : '#dc2626'}`,\n    );\n    console.log('Request:', { url, init });\n    console.log('Response headers:', getHeadersAsRecord(res.headers));\n    console.log('Response body:', data);\n    console.log('Duration:', Math.round(performance.now() - started) + 'ms');\n    console.groupEnd();\n  }\n\n  if (!res.ok) {\n    throw new Error((data && (data.message || data.error)) || `HTTP ${res.status}`);\n  }\n\n  return data as T;\n}\n","import { j } from './http';\n\ntype DmnVenuesJson = { payload?: { pages?: Venue[] } };\ntype Venue = { _id: string; title: string; name?: string; path: string };\n\nexport function getPackages(venue_id: string) {\n  return j<{ data: Array<{ id: string; label: string }> }>(\n    `/wp-json/dmn/v1/packages?venue_id=${encodeURIComponent(venue_id)}`,\n  );\n}\n\nexport function getBookingTypes(venue_id: string) {\n  return j<{ data: Array<{ id: string; name: string; description?: string; priceText?: string }> }>(\n    `/wp-json/dmn/v1/booking-types?venue_id=${encodeURIComponent(venue_id)}`,\n  );\n}\n\nexport function getVenues(q: { venue_group?: string; fields?: string } = {}) {\n  const qs = new URLSearchParams(q as Record<string, string>);\n  return j<{\n    data: any;\n    payload: { pages: Venue[] };\n  }>('venues' + (qs.toString() ? `?${qs}` : ''));\n}\n\nexport type AvailabilityReq = {\n  venue_id: string;\n  num_people?: number;\n  date?: string; // YYYY-MM-DD\n  time?: string; // HH:mm\n  type?: string;\n  duration?: number; // hours, decimal (DMN accepts) or minutes if your server converts\n  getOffers?: boolean;\n};\nexport type AvailabilityRes = {\n  payload: {\n    valid: boolean;\n    validation?: Record<string, unknown>;\n    action?: 'accept' | 'enquire' | 'may_enquire' | 'reject';\n    next?: { web?: string; api?: string };\n    bookingDetails?: Record<string, unknown>;\n  };\n  status: number;\n};\n\nexport function checkAvailability(p: AvailabilityReq) {\n  return j<AvailabilityRes>('booking-availability', { method: 'POST', body: JSON.stringify(p) });\n}\n\n// Optional if you choose API submission when permitted by DMN\nexport type BookingReq = {\n  source: 'partner';\n  first_name: string;\n  last_name: string;\n  email: string;\n  phone?: string;\n  dob?: string;\n  num_people: number;\n  type: string;\n  venue_id: string;\n  date: string;\n  time: string;\n  duration?: number;\n  offer?: string;\n  notes?: string;\n  package?: string;\n  newsletter_signup?: boolean;\n  marketing_preferences?: string[];\n  custom_field_value?: string;\n};\nexport type BookingRes = { payload?: any; status: number };\n\nexport function createBooking(p: BookingReq) {\n  return j<BookingRes>('bookings', { method: 'POST', body: JSON.stringify(p) });\n}\n","import * as React from 'react';\nimport { useEffect, useReducer, useState } from 'react';\nimport { initialState, reducer } from './state';\nimport { AvailabilityReq, checkAvailability, getVenues } from '../api/public';\n\n// Optional helpers if you add them to ../api/public later:\n// import { getPackages, createBooking, getBookingTypes } from '../api/public';\n\ntype RootProps = {\n  venueGroup?: string;\n  forcedVenueId?: string;\n  corpThreshold?: number;\n  corpEnquiryUrl?: string;\n  returnUrl?: string;\n};\n\nconst SIX_MONTHS_MS = 1000 * 60 * 60 * 24 * 30 * 6;\nconst todayISO = () => new Date().toISOString().slice(0, 10);\nconst sixMonthsISO = () => new Date(Date.now() + SIX_MONTHS_MS).toISOString().slice(0, 10);\n\n// Fallback time suggestion generator (if API doesn't give suggestions)\nfunction nearestQuarterTimes(baseHHmm: string, count = 3): string[] {\n  const [h, m] = baseHHmm.split(':').map(Number);\n  const mins = h * 60 + m;\n  const candidates = [15, -15, 30, -30, 45, -45]\n    .map((offset) => mins + offset)\n    .filter((v) => v >= 0 && v < 24 * 60);\n  const dedup = new Set<string>();\n  for (const c of candidates) {\n    const hh = String(Math.floor(c / 60)).padStart(2, '0');\n    const mm = String(c % 60).padStart(2, '0');\n    dedup.add(`${hh}:${mm}`);\n    if (dedup.size >= count) break;\n  }\n  return Array.from(dedup);\n}\n\ntype UnknownRecord = Record<string, unknown>;\nfunction getSuggestedTimes(validation: unknown): string[] {\n  if (!validation || typeof validation !== 'object') return [];\n  const v = validation as UnknownRecord;\n\n  // DMN commonly uses either \"time\" or \"booking_time\"\n  const tryKey = (key: string): string[] => {\n    const node = v[key];\n    if (node && typeof node === 'object') {\n      const sv = (node as { suggestedValues?: unknown }).suggestedValues;\n      if (Array.isArray(sv) && sv.every((x) => typeof x === 'string')) return sv;\n    }\n    return [];\n  };\n\n  return tryKey('time').length ? tryKey('time') : tryKey('booking_time');\n}\n\nexport default function WidgetRoot({\n  venueGroup,\n  forcedVenueId,\n  corpThreshold = 20,\n  corpEnquiryUrl,\n  returnUrl,\n}: RootProps) {\n  const [state, dispatch] = useReducer(reducer, {\n    ...initialState,\n    step: forcedVenueId ? 'stage1' : 'venue',\n    venueId: forcedVenueId ?? null,\n  });\n\n  // ========= Venues (only when not forced) =========\n  const [venues, setVenues] = useState<\n    Array<{ title: string; _id: string; name?: string; path: string }>\n  >([]);\n  const [vLoading, setVLoading] = useState(false);\n  const [vErr, setVErr] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (forcedVenueId) return;\n    (async () => {\n      try {\n        setVLoading(true);\n        setVErr(null);\n        const res = await getVenues({ venue_group: venueGroup, fields: 'path,name,title' });\n        setVenues(res.data.payload?.pages || []);\n      } catch (e: any) {\n        setVErr(e?.message || 'Failed to load venues');\n      } finally {\n        setVLoading(false);\n      }\n    })();\n  }, [venueGroup, forcedVenueId]);\n\n  // ========= Booking Types (Experience) =========\n  const [types, setTypes] = useState<\n    Array<{ id: string; name: string; description?: string; priceText?: string }>\n  >([]);\n  const [typesLoading, setTypesLoading] = useState(false);\n\n  async function loadTypes() {\n    if (!state.venueId || !state.date || !state.partySize) return;\n    try {\n      setTypesLoading(true);\n\n      // 1) try WP-configured types first (keeps friendly names if you have them)\n      const res = await fetch(\n        `/wp-json/dmn/v1/booking-types?venue_id=${encodeURIComponent(state.venueId)}`,\n      );\n      const json = await res.json();\n      const configured = Array.isArray(json?.data) ? json.data : [];\n      if (configured.length > 0) {\n        setTypes(\n          configured.map((t: any) => ({\n            id: String(t.id),\n            name: t.name || String(t.id),\n            description: t.description || '',\n            priceText: t.priceText || '',\n          })),\n        );\n        return;\n      }\n\n      // 2) fallback: ask availability WITHOUT a type to get DMN’s suggestions\n      const avRes = await fetch(`/wp-json/dmn/v1/booking-availability`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          venue_id: state.venueId,\n          num_people: state.partySize,\n          date: state.date,\n          // no type here on purpose\n        }),\n      });\n      const avJson = await avRes.json();\n\n      // Handles both shapes:\n      // - suggestedValues: string[]\n      // - suggestedValues: { value: { id, name, ... }, valid, ... }[]\n      const rawSuggested =\n        avJson?.validation?.type?.suggestedValues ??\n        avJson?.data?.payload?.validation?.type?.suggestedValues ??\n        [];\n\n      const suggestedTypes = (Array.isArray(rawSuggested) ? rawSuggested : [])\n        .map((item: any) => {\n          const v = item && typeof item === 'object' && 'value' in item ? item.value : item;\n          return v && typeof v === 'object'\n            ? { id: String(v.id), name: v.name || String(v.id) }\n            : typeof v === 'string'\n              ? { id: v, name: v }\n              : null;\n        })\n        .filter(Boolean) as Array<{ id: string; name: string }>;\n\n      // de-dupe by id and set\n      const seen = new Set<string>();\n      const finalTypes = suggestedTypes\n        .filter((t) => {\n          if (seen.has(t.id)) return false;\n          seen.add(t.id);\n          return true;\n        })\n        .map((t) => ({\n          id: t.id,\n          name: t.name,\n          description: '', // optional: you can enrich later from WP\n          priceText: '',\n        }));\n\n      setTypes(finalTypes);\n    } catch {\n      setTypes([]);\n    } finally {\n      setTypesLoading(false);\n    }\n  }\n\n  // When we arrive on the \"type\" step with base inputs ready, fetch types\n  useEffect(() => {\n    if (state.step === 'type') loadTypes();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [state.step, state.venueId, state.date, state.partySize]);\n\n  // ========= Packages (per venue) =========\n  const [pkLoading, setPkLoading] = useState(false);\n\n  async function loadPackages() {\n    if (!state.venueId) return;\n    try {\n      setPkLoading(true);\n      const res = await fetch(\n        `/wp-json/dmn/v1/packages?venue_id=${encodeURIComponent(state.venueId)}`,\n      );\n      const json = await res.json();\n      dispatch({ type: 'SET_PACKAGES', value: json?.data || [] });\n    } catch {\n      dispatch({ type: 'SET_PACKAGES', value: [] });\n    } finally {\n      setPkLoading(false);\n    }\n  }\n\n  useEffect(() => {\n    if (state.step === 'packages') loadPackages();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [state.step, state.venueId]);\n\n  // ========= Availability =========\n  async function runAvailability(opts: { includeTime?: boolean } = {}) {\n    if (!state.venueId || !state.partySize || !state.date) {\n      dispatch({ type: 'ERROR', message: 'Please choose venue, guests and date first.' });\n      return;\n    }\n    if (!state.bookingType) {\n      // Type is mandatory at many venues\n      dispatch({ type: 'ERROR', message: 'Please choose an experience.' });\n      return;\n    }\n    dispatch({ type: 'ERROR', message: null });\n    const payload: AvailabilityReq = {\n      venue_id: state.venueId,\n      num_people: state.partySize,\n      date: state.date,\n      ...(state.bookingType ? { type: state.bookingType } : {}),\n      ...(opts.includeTime && state.time ? { time: state.time } : {}),\n      // getOffers?: true // optional if you want offers surfaced here\n    };\n    const r = await checkAvailability(payload);\n    const valid = !!r?.payload?.valid;\n    const action = r?.payload?.action as any;\n    const nextWeb = r?.payload?.next?.web as string | undefined;\n\n    // Extract suggested times from validation if present\n    const suggested = getSuggestedTimes(r?.payload?.validation);\n\n    dispatch({ type: 'SET_AVAIL', value: { valid, action, nextWeb: nextWeb || null } });\n    if (!valid && state.time) {\n      const fallback = suggested.length\n        ? suggested.slice(0, 3)\n        : nearestQuarterTimes(state.time, 3);\n      dispatch({ type: 'SET_SUGGESTIONS', value: fallback });\n    } else {\n      dispatch({ type: 'SET_SUGGESTIONS', value: [] });\n    }\n    return { valid, action, nextWeb, suggested };\n  }\n\n  // ========= Corporate threshold guard =========\n  useEffect(() => {\n    if (state.step === 'stage1' && corpEnquiryUrl && state.partySize > (corpThreshold || 20)) {\n      window.location.assign(corpEnquiryUrl);\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [state.partySize, state.step, corpThreshold, corpEnquiryUrl]);\n\n  // Auto-continue when only one type exists\n  useEffect(() => {\n    if (state.step !== 'type' || !types.length) return;\n    if (types.length === 1 && !state.bookingType) {\n      dispatch({ type: 'SET_TYPE', value: types[0].id });\n      (async () => {\n        await runAvailability();\n        dispatch({ type: 'NEXT' });\n      })();\n    }\n  }, [state.step, types, state.bookingType]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  // ========= Review countdown =========\n  const [now, setNow] = useState(Date.now());\n  useEffect(() => {\n    if (state.step !== 'review') return;\n    const deadline = Date.now() + 10 * 60 * 1000; // 10 min\n    dispatch({ type: 'START_REVIEW_TIMER', deadline });\n    const t = setInterval(() => setNow(Date.now()), 1000);\n    return () => clearInterval(t);\n  }, [state.step]);\n  const remainingSec = Math.max(0, Math.floor(((state.reviewDeadline || 0) - now) / 1000));\n  const mm = String(Math.floor(remainingSec / 60)).padStart(2, '0');\n  const ss = String(remainingSec % 60).padStart(2, '0');\n  const expired = remainingSec <= 0;\n\n  // ========= Create booking then redirect =========\n  async function onConfirm() {\n    if (expired) {\n      dispatch({ type: 'ERROR', message: 'Your selection expired. Please re-check availability.' });\n      return;\n    }\n    if (!state.venueId || !state.partySize || !state.date || !state.time || !state.bookingType) {\n      dispatch({ type: 'ERROR', message: 'Missing details. Please complete all steps.' });\n      return;\n    }\n\n    // Build a custom_field_value string for accounting/reporting\n    const packageLabels = state.packages\n      .filter((p) => state.packagesSelected.includes(p.id))\n      .map((p) => p.label)\n      .join(', ');\n\n    // Split customer name to DMN fields\n    const [first_name, ...rest] = (state.customer.name || '').trim().split(/\\s+/);\n    const last_name = rest.join(' ');\n\n    try {\n      const resp = await fetch('/wp-json/dmn/v1/create-booking', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          venue_id: state.venueId,\n          type: state.bookingType,\n          date: state.date,\n          time: state.time,\n          num_people: state.partySize,\n          customer: {\n            first_name,\n            last_name,\n            email: state.customer.email,\n            phone: state.customer.phone,\n          },\n          // DMN supports both `package` and `custom_field_value` fields — use what your account maps\n          package: packageLabels,\n          custom_field_value: packageLabels,\n          return_url: returnUrl, // DMN will redirect back with reference/status/etc.\n        }),\n      });\n      const json = await resp.json();\n      const nextWeb = json?.data?.next?.web || json?.next?.web; // support either shape\n      if (nextWeb) {\n        window.location.assign(nextWeb);\n      } else {\n        dispatch({ type: 'ERROR', message: 'Booking created but no redirect URL returned.' });\n      }\n    } catch (e: any) {\n      dispatch({ type: 'ERROR', message: e?.message || 'Failed to create booking.' });\n    }\n  }\n\n  return (\n    <div className=\"dmn-widget\" role=\"form\" aria-labelledby=\"dmn-title\">\n      {state.error && (\n        <p className=\"dmn-widget__error\" role=\"alert\">\n          {state.error}\n        </p>\n      )}\n\n      {/* ========== PRE: Venue (only for multi-venue) ========== */}\n      {state.step === 'venue' && (\n        <div className=\"dmn-widget__step\">\n          <h3 className=\"dmn-widget__title\">Choose a venue</h3>\n          {vLoading && <p>Loading venues…</p>}\n          {vErr && <p className=\"dmn-widget__error\">{vErr}</p>}\n          {!vLoading && !vErr && (\n            <div className=\"dmn-widget__field\">\n              <label className=\"dmn-widget__label\">Venue</label>\n              <select\n                className=\"dmn-widget__select\"\n                value={state.venueId || ''}\n                onChange={(e) => dispatch({ type: 'SET_VENUE', id: e.target.value || null })}\n              >\n                <option value=\"\" disabled>\n                  Choose…\n                </option>\n                {venues.map((v) => (\n                  <option key={v._id} value={v._id}>\n                    {v.name || v.title}\n                  </option>\n                ))}\n              </select>\n            </div>\n          )}\n          <div className=\"dmn-widget__actions\">\n            <button\n              className=\"dmn-widget__btn\"\n              disabled={!state.venueId}\n              onClick={() => dispatch({ type: 'NEXT' })}\n            >\n              Continue\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* ========== Stage 1: Guests + Date ========== */}\n      {state.step === 'stage1' && (\n        <div className=\"dmn-widget__step\">\n          <h3 className=\"dmn-widget__title\">Guests & date</h3>\n          <div className=\"dmn-widget__field\">\n            <label className=\"dmn-widget__label\">Number of guests</label>\n            <input\n              className=\"dmn-widget__input\"\n              type=\"number\"\n              min={1}\n              max={100}\n              value={state.partySize}\n              onChange={(e) => {\n                const size = Math.max(1, Number(e.target.value || 1));\n                dispatch({ type: 'SET_GUESTS_DATE', size, date: state.date || todayISO() });\n              }}\n            />\n          </div>\n          <div className=\"dmn-widget__field\">\n            <label className=\"dmn-widget__label\">Date</label>\n            <input\n              className=\"dmn-widget__input\"\n              type=\"date\"\n              min={todayISO()}\n              max={sixMonthsISO()}\n              value={state.date || ''}\n              onChange={(e) =>\n                dispatch({ type: 'SET_GUESTS_DATE', size: state.partySize, date: e.target.value })\n              }\n            />\n          </div>\n          <div className=\"dmn-widget__hint\">We’ll check availability next.</div>\n          <div className=\"dmn-widget__actions\">\n            <button\n              className=\"dmn-widget__btn dmn-widget__btn--ghost\"\n              onClick={() => dispatch({ type: 'BACK' })}\n            >\n              Back\n            </button>\n            <button\n              className=\"dmn-widget__btn\"\n              disabled={!(state.venueId || forcedVenueId)}\n              onClick={() => {\n                if (!state.date) {\n                  dispatch({ type: 'SET_GUESTS_DATE', size: state.partySize, date: todayISO() });\n                }\n                dispatch({ type: 'NEXT' });\n              }}\n            >\n              Continue\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* ========== Stage 2: Experience / Booking Type ========== */}\n      {state.step === 'type' && (\n        <div className=\"dmn-widget__step\">\n          <h3 className=\"dmn-widget__title\">Choose an experience</h3>\n          {typesLoading && <p>Loading experiences…</p>}\n          {!typesLoading && (\n            <div className=\"dmn-widget__field\">\n              {types.length === 0 && <p>No experiences configured.</p>}\n              {types.map((t) => (\n                <label key={t.id} className=\"dmn-widget__radio\">\n                  <input\n                    type=\"radio\"\n                    name=\"bookingType\"\n                    value={t.id}\n                    checked={state.bookingType === t.id}\n                    onChange={() => dispatch({ type: 'SET_TYPE', value: t.id })}\n                  />\n                  <span className=\"dmn-widget__radio-label\">\n                    <strong>{t.name}</strong>\n                    {t.priceText ? ` — ${t.priceText}` : ''}\n                    {t.description ? <em> — {t.description}</em> : ''}\n                  </span>\n                </label>\n              ))}\n            </div>\n          )}\n          <div className=\"dmn-widget__actions\">\n            <button\n              className=\"dmn-widget__btn dmn-widget__btn--ghost\"\n              onClick={() => dispatch({ type: 'BACK' })}\n            >\n              Back\n            </button>\n            <button\n              className=\"dmn-widget__btn\"\n              disabled={!state.bookingType}\n              onClick={() => {\n                // Validate base inputs (venue + guests + date + type).\n                runAvailability();\n                dispatch({ type: 'NEXT' });\n              }}\n            >\n              Continue\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* ========== Stage 3: Time ========== */}\n      {state.step === 'time' && (\n        <div className=\"dmn-widget__step\">\n          <h3 className=\"dmn-widget__title\">Choose a time</h3>\n          <div className=\"dmn-widget__field\">\n            <label className=\"dmn-widget__label\">Time</label>\n            <input\n              className=\"dmn-widget__input\"\n              type=\"time\"\n              step={900} // 15 min\n              value={state.time || ''}\n              onChange={(e) => dispatch({ type: 'SET_TIME', value: e.target.value })}\n            />\n          </div>\n          <div className=\"dmn-widget__actions\">\n            <button\n              className=\"dmn-widget__btn dmn-widget__btn--ghost\"\n              onClick={() => dispatch({ type: 'BACK' })}\n            >\n              Back\n            </button>\n            <button\n              className=\"dmn-widget__btn\"\n              onClick={async () => {\n                const r = await runAvailability({ includeTime: true });\n                if (r?.valid) dispatch({ type: 'NEXT' });\n              }}\n            >\n              Check availability\n            </button>\n          </div>\n\n          {!!state.suggestions.length && (\n            <div className=\"dmn-widget__hint\">\n              Not available then. Try:\n              <div className=\"dmn-widget__chips\">\n                {state.suggestions.map((s) => (\n                  <button\n                    key={s}\n                    className=\"dmn-widget__chip\"\n                    onClick={async () => {\n                      dispatch({ type: 'SET_TIME', value: s });\n                      const r = await runAvailability({ includeTime: true });\n                      if (r?.valid) dispatch({ type: 'NEXT' });\n                    }}\n                  >\n                    {s}\n                  </button>\n                ))}\n              </div>\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* ========== Step: Packages ========== */}\n      {state.step === 'packages' && (\n        <div className=\"dmn-widget__step\">\n          <h3 className=\"dmn-widget__title\">Add-on packages</h3>\n          {pkLoading && <p>Loading packages…</p>}\n          {!pkLoading && (\n            <ul className=\"dmn-widget__list\">\n              {state.packages.map((p) => (\n                <li key={p.id}>\n                  <label className=\"dmn-widget__checkbox\">\n                    <input\n                      type=\"checkbox\"\n                      checked={state.packagesSelected.includes(p.id)}\n                      onChange={(e) => {\n                        const next = new Set(state.packagesSelected);\n                        e.target.checked ? next.add(p.id) : next.delete(p.id);\n                        dispatch({ type: 'SET_PACKAGES_SELECTED', value: Array.from(next) });\n                      }}\n                    />\n                    <span>{p.label}</span>\n                  </label>\n                </li>\n              ))}\n            </ul>\n          )}\n          <div className=\"dmn-widget__actions\">\n            <button\n              className=\"dmn-widget__btn dmn-widget__btn--ghost\"\n              onClick={() => dispatch({ type: 'BACK' })}\n            >\n              Back\n            </button>\n            <button className=\"dmn-widget__btn\" onClick={() => dispatch({ type: 'NEXT' })}>\n              Continue\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* ========== Step: Customer Details ========== */}\n      {state.step === 'details' && (\n        <div className=\"dmn-widget__step\">\n          <h3 className=\"dmn-widget__title\">Your details</h3>\n          <div className=\"dmn-widget__field\">\n            <label className=\"dmn-widget__label\">Name</label>\n            <input\n              className=\"dmn-widget__input\"\n              value={state.customer.name}\n              onChange={(e) =>\n                dispatch({\n                  type: 'SET_CUSTOMER',\n                  value: { ...state.customer, name: e.target.value },\n                })\n              }\n            />\n          </div>\n          <div className=\"dmn-widget__field\">\n            <label className=\"dmn-widget__label\">Email</label>\n            <input\n              className=\"dmn-widget__input\"\n              type=\"email\"\n              value={state.customer.email}\n              onChange={(e) =>\n                dispatch({\n                  type: 'SET_CUSTOMER',\n                  value: { ...state.customer, email: e.target.value },\n                })\n              }\n            />\n          </div>\n          <div className=\"dmn-widget__field\">\n            <label className=\"dmn-widget__label\">Phone (optional)</label>\n            <input\n              className=\"dmn-widget__input\"\n              value={state.customer.phone || ''}\n              onChange={(e) =>\n                dispatch({\n                  type: 'SET_CUSTOMER',\n                  value: { ...state.customer, phone: e.target.value },\n                })\n              }\n            />\n          </div>\n          <div className=\"dmn-widget__field\">\n            <label className=\"dmn-widget__label\">Message (optional)</label>\n            <textarea\n              className=\"dmn-widget__textarea\"\n              value={state.customer.message || ''}\n              onChange={(e) =>\n                dispatch({\n                  type: 'SET_CUSTOMER',\n                  value: { ...state.customer, message: e.target.value },\n                })\n              }\n            />\n          </div>\n          <label className=\"dmn-widget__checkbox\">\n            <input\n              type=\"checkbox\"\n              checked={!!state.customer.gdpr}\n              onChange={(e) =>\n                dispatch({\n                  type: 'SET_CUSTOMER',\n                  value: { ...state.customer, gdpr: e.target.checked },\n                })\n              }\n            />\n            <span>I agree to be contacted (GDPR).</span>\n          </label>\n          <div className=\"dmn-widget__actions\">\n            <button\n              className=\"dmn-widget__btn dmn-widget__btn--ghost\"\n              onClick={() => dispatch({ type: 'BACK' })}\n            >\n              Back\n            </button>\n            <button className=\"dmn-widget__btn\" onClick={() => dispatch({ type: 'NEXT' })}>\n              Review\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* ========== Step: Review (promo + FAQ + countdown) ========== */}\n      {state.step === 'review' && (\n        <div className=\"dmn-widget__step\">\n          <h3 className=\"dmn-widget__title\">Review & confirm</h3>\n\n          {/* Summary */}\n          <ul className=\"dmn-widget__summary\">\n            <li>\n              Venue: <code>{state.venueId}</code>\n            </li>\n            <li>Guests: {state.partySize}</li>\n            <li>Date: {state.date}</li>\n            <li>Time: {state.time}</li>\n            <li>Experience: {state.bookingType}</li>\n            <li>\n              Packages:{' '}\n              {state.packages\n                .filter((p) => state.packagesSelected.includes(p.id))\n                .map((p) => p.label)\n                .join(', ') || 'None'}\n            </li>\n            <li>\n              Name/Email: {state.customer.name} / {state.customer.email}\n            </li>\n          </ul>\n\n          {/* Promo slider (simple manual) */}\n          <div className=\"dmn-widget__promo\">\n            <div className=\"dmn-widget__promo-item\">\n              <img src=\"/path/to/promo1.jpg\" alt=\"\" />\n              <div>\n                <strong>Summer specials</strong> — Save 10% on midweek bookings\n              </div>\n            </div>\n            {/* Add more slides if desired */}\n          </div>\n\n          {/* FAQ accordion (basic) */}\n          <details className=\"dmn-widget__faq\">\n            <summary>Can I change my booking later?</summary>\n            <p>Contact the venue via your confirmation email.</p>\n          </details>\n          <details className=\"dmn-widget__faq\">\n            <summary>What if I’m running late?</summary>\n            <p>Please let the venue know; policies vary.</p>\n          </details>\n\n          {/* Countdown */}\n          <p className={`dmn-widget__countdown${expired ? ' is-expired' : ''}`}>\n            Hold expires in{' '}\n            <strong>\n              {mm}:{ss}\n            </strong>\n          </p>\n\n          <div className=\"dmn-widget__actions\">\n            <button\n              className=\"dmn-widget__btn dmn-widget__btn--ghost\"\n              onClick={() => dispatch({ type: 'BACK' })}\n            >\n              Back\n            </button>\n            <button className=\"dmn-widget__btn\" onClick={onConfirm} disabled={expired}>\n              Continue to payment\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","// state.ts\n\n// ---- Steps in DMN-recommended order ----\nexport type Step =\n  | 'venue' // pre-step (only shown if multi-venue)\n  | 'stage1' // guests + date\n  | 'type' // experience / booking type\n  | 'time' // time selection\n  | 'packages' // add-on packages\n  | 'details' // customer details\n  | 'review'; // summary + countdown\n\n// Keep Customer in sync with how it's used in the widget (message + gdpr supported)\nexport type Customer = {\n  name: string;\n  email: string;\n  phone?: string;\n  message?: string;\n  gdpr?: boolean;\n};\n\nexport type Availability = {\n  valid: boolean;\n  action?: 'accept' | 'enquire' | 'may_enquire' | 'reject';\n  nextWeb?: string | null;\n} | null;\n\nexport type State = {\n  step: Step;\n  venueId?: string | null;\n\n  partySize: number;\n  date?: string | null; // YYYY-MM-DD\n  time?: string | null; // HH:mm\n  bookingType?: string | null;\n\n  avail?: Availability;\n  suggestions: string[]; // suggested times (from API or fallback)\n\n  packages: Array<{ id: string; label: string }>;\n  packagesSelected: string[]; // ids\n\n  customer: Customer;\n  error: string | null;\n\n  // review countdown\n  reviewDeadline?: number; // epoch ms\n\n  // create-booking UX flag\n  submitting: boolean;\n};\n\n// Single source of truth for flow order\nexport const FLOW_ORDER: Step[] = [\n  'venue',\n  'stage1',\n  'type',\n  'time',\n  'packages',\n  'details',\n  'review',\n];\n\n// ---- Defaults ----\n// NOTE: Widget sets the first step dynamically:\n// - forcedVenueId ? 'stage1' : 'venue'\nexport const initialState: State = {\n  step: 'stage1',\n  venueId: null,\n\n  partySize: 2,\n  date: null,\n  time: null,\n  bookingType: null,\n\n  avail: null,\n  suggestions: [],\n\n  packages: [],\n  packagesSelected: [],\n\n  customer: { name: '', email: '' },\n  error: null,\n\n  submitting: false,\n};\n\nexport type Action =\n  | { type: 'SET_VENUE'; id: string | null }\n  | { type: 'SET_GUESTS_DATE'; size: number; date: string } // Stage 1\n  | { type: 'SET_TYPE'; value: string | null } // Stage 2\n  | { type: 'SET_TIME'; value: string | null } // Stage 3\n  | { type: 'SET_AVAIL'; value: State['avail'] }\n  | { type: 'SET_SUGGESTIONS'; value: string[] }\n  | { type: 'SET_PACKAGES'; value: State['packages'] }\n  | { type: 'SET_PACKAGES_SELECTED'; value: string[] }\n  | { type: 'SET_CUSTOMER'; value: State['customer'] }\n  | { type: 'START_REVIEW_TIMER'; deadline: number }\n  | { type: 'SUBMIT_START' }\n  | { type: 'SUBMIT_END' }\n  | { type: 'ERROR'; message: string | null }\n  | { type: 'NEXT' }\n  | { type: 'BACK' };\n\nexport function reducer(s: State, a: Action): State {\n  switch (a.type) {\n    case 'SET_VENUE':\n      return { ...s, venueId: a.id, avail: null, suggestions: [] };\n\n    case 'SET_GUESTS_DATE': {\n      const dateChanged = a.date !== s.date;\n      return {\n        ...s,\n        partySize: Math.max(1, a.size),\n        date: a.date,\n        // Reset time/availability if the date changed\n        time: dateChanged ? null : s.time,\n        avail: dateChanged ? null : s.avail,\n        suggestions: [],\n      };\n    }\n\n    case 'SET_TYPE':\n      return {\n        ...s,\n        bookingType: a.value,\n        // Changing type invalidates previous time/availability\n        time: null,\n        avail: null,\n        suggestions: [],\n      };\n\n    case 'SET_TIME':\n      return { ...s, time: a.value ?? null };\n\n    case 'SET_AVAIL':\n      return { ...s, avail: a.value || null };\n\n    case 'SET_SUGGESTIONS':\n      return { ...s, suggestions: a.value || [] };\n\n    case 'SET_PACKAGES':\n      return { ...s, packages: a.value || [] };\n\n    case 'SET_PACKAGES_SELECTED':\n      return { ...s, packagesSelected: a.value || [] };\n\n    case 'SET_CUSTOMER':\n      return { ...s, customer: a.value };\n\n    case 'START_REVIEW_TIMER':\n      return { ...s, reviewDeadline: a.deadline };\n\n    case 'SUBMIT_START':\n      return { ...s, submitting: true, error: null };\n\n    case 'SUBMIT_END':\n      return { ...s, submitting: false };\n\n    case 'ERROR':\n      return { ...s, error: a.message };\n\n    case 'NEXT': {\n      const idx = FLOW_ORDER.indexOf(s.step);\n      const nextIdx = Math.min(FLOW_ORDER.length - 1, idx + 1);\n      return { ...s, step: FLOW_ORDER[nextIdx] };\n    }\n\n    case 'BACK': {\n      const idx = FLOW_ORDER.indexOf(s.step);\n      const prevIdx = Math.max(0, idx - 1);\n      return { ...s, step: FLOW_ORDER[prevIdx] };\n    }\n\n    default:\n      return s;\n  }\n}\n","import * as React from 'react';\nimport { createRoot } from 'react-dom/client';\nimport WidgetRoot from './app/WidgetRoot';\n\nfunction boot(el: HTMLElement) {\n  const props = {\n    venueGroup: el.dataset.venueGroup || undefined,\n    forcedVenueId: el.dataset.venueId || undefined,\n    corpThreshold: Number(el.dataset.corpThreshold || 20),\n    corpEnquiryUrl: el.dataset.corpEnquiryUrl || undefined,\n    returnUrl: el.dataset.returnUrl || undefined,\n  };\n  createRoot(el).render(<WidgetRoot {...(props as any)} />);\n}\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  document.querySelectorAll<HTMLElement>('.dmn-widget-root').forEach(boot);\n});\n","// extracted by mini-css-extract-plugin\nexport {};","module.exports = window[\"React\"];","module.exports = window[\"ReactDOM\"];","module.exports = window[\"ReactJSXRuntime\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import './styles/index.scss';\nimport './index.tsx';\n"],"names":["DEBUG","getHeadersAsRecord","headers","out","forEach","value","key","j","path","init","url","window","DMN_PUBLIC_BOOT","restUrl","started","performance","now","res","fetch","data","clone","json","text","console","groupCollapsed","method","status","ok","log","Math","round","groupEnd","Error","message","error","getPackages","venue_id","encodeURIComponent","getBookingTypes","getVenues","q","qs","URLSearchParams","toString","checkAvailability","p","body","JSON","stringify","createBooking","React","useEffect","useReducer","useState","initialState","reducer","jsx","_jsx","jsxs","_jsxs","SIX_MONTHS_MS","todayISO","Date","toISOString","slice","sixMonthsISO","nearestQuarterTimes","baseHHmm","count","h","m","split","map","Number","mins","candidates","offset","filter","v","dedup","Set","c","hh","String","floor","padStart","mm","add","size","Array","from","getSuggestedTimes","validation","tryKey","node","sv","suggestedValues","isArray","every","x","length","WidgetRoot","venueGroup","forcedVenueId","corpThreshold","corpEnquiryUrl","returnUrl","state","dispatch","step","venueId","venues","setVenues","vLoading","setVLoading","vErr","setVErr","venue_group","fields","payload","pages","e","types","setTypes","typesLoading","setTypesLoading","loadTypes","date","partySize","_ref","_avJson$validation$ty","configured","t","id","name","description","priceText","avRes","num_people","avJson","rawSuggested","type","suggestedTypes","item","Boolean","seen","finalTypes","has","pkLoading","setPkLoading","loadPackages","runAvailability","opts","bookingType","includeTime","time","r","valid","action","nextWeb","next","web","suggested","fallback","location","assign","setNow","deadline","setInterval","clearInterval","remainingSec","max","reviewDeadline","ss","expired","onConfirm","packageLabels","packages","packagesSelected","includes","label","join","first_name","rest","customer","trim","last_name","resp","email","phone","package","custom_field_value","return_url","className","role","children","onChange","target","disabled","_id","title","onClick","min","checked","suggestions","s","delete","gdpr","src","alt","FLOW_ORDER","avail","submitting","a","_a$value","dateChanged","idx","indexOf","nextIdx","prevIdx","createRoot","boot","el","props","dataset","undefined","render","document","addEventListener","querySelectorAll"],"sourceRoot":""}